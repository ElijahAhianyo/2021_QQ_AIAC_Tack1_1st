# Job1 Optim

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-job1.optim.create_optimizer.create_optimizer-start--->
## [job1.optim.create_optimizer.create_optimizer](3-job1_optim.md#job1.optim.create_optimizer.create_optimizer)

<!---Documatic-section-create_optimizer-start--->
<!---Documatic-block-job1.optim.create_optimizer.create_optimizer-start--->
<details>
	<summary><code>job1.optim.create_optimizer.create_optimizer</code> code snippet</summary>

```python
def create_optimizer(model, model_lr={'others': 0.005, 'nextvlad': 0.0005, 'roberta': 5e-05}, weight_decay=0.01, layerwise_learning_rate_decay=0.975, adam_epsilon=1e-06, use_bertadam=False):
    no_decay = ['bias', 'LayerNorm.weight']
    optimizer_grouped_parameters = []
    for layer_name in model_lr:
        lr = model_lr[layer_name]
        if layer_name != 'others':
            optimizer_grouped_parameters += [{'params': [p for (n, p) in model.named_parameters() if not any((nd in n for nd in no_decay)) and layer_name in n], 'weight_decay': weight_decay, 'lr': lr}, {'params': [p for (n, p) in model.named_parameters() if any((nd in n for nd in no_decay)) and layer_name in n], 'weight_decay': 0.0, 'lr': lr}]
        else:
            optimizer_grouped_parameters += [{'params': [p for (n, p) in model.named_parameters() if not any((nd in n for nd in no_decay)) and (not any((name in n for name in model_lr)))], 'weight_decay': weight_decay, 'lr': lr}, {'params': [p for (n, p) in model.named_parameters() if any((nd in n for nd in no_decay)) and (not any((name in n for name in model_lr)))], 'weight_decay': 0.0, 'lr': lr}]
    optimizer = AdamW(optimizer_grouped_parameters, lr=model_lr['roberta'], eps=adam_epsilon, correct_bias=not use_bertadam)
    return optimizer
```
</details>
<!---Documatic-block-job1.optim.create_optimizer.create_optimizer-end--->
<!---Documatic-section-create_optimizer-end--->

# #
<!---Documatic-section-job1.optim.create_optimizer.create_optimizer-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)